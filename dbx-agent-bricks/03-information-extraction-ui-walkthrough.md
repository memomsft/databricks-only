# 03 – Information Extraction (UI Walkthrough)

This pattern turns **unstructured documents** (contracts, receipts, notes) into a **structured Delta table**.  
It automates repetitive tasks like manual data entry.

---

## Why it matters

- **Automation:** Extract fields like amounts, dates, or IDs from documents without coding.  
- **Consistency:** Define a schema once, apply it across thousands of files.  
- **Integration:** Results are written as Delta tables in Unity Catalog, ready for analytics or ML.  
- **Evaluation:** Built-in support for MLflow and Agent Evaluation enables continuous improvement.

---

## Steps

1. Open **Agent Bricks → Information Extraction**.  
2. Click **Build** → name the agent, e.g. `Retail-IE-Demo`.  
3. **Input:** select the JSON/JSONL files generated by the data prep script:  
   - `/Volumes/main/demo_llm/agent_docs/contracts/contracts.jsonl`  
   - `/Volumes/main/demo_llm/agent_docs/receipts/receipts.jsonl`  
   - `/Volumes/main/demo_llm/agent_docs/notes/notes.jsonl`  

   > Supported formats: JSON, JSONL, TXT, MD, XML, DOC/DOCX, PDF (PDFs must first be converted into a Unity Catalog table).  

4. **Schema:** define the fields to extract, e.g.:  
   - `doc_id: string`  
   - `customer_id: int`  
   - `contract_value: double`  
   - `term_months: int`  
   - `amount: double`  
   - `ts: timestamp`  

   You can also define nested fields, arrays, and booleans.  

5. **Output:** write to a new table in Unity Catalog, e.g.:  
   - `main.demo_llm.ie_extracted_contracts`  

6. Run and check the Delta table in **Data Explorer**.

---

## Expected outcome

- A **structured Delta table** with extracted fields.  
- Each row includes a reference back to the original unstructured doc in the UC Volume.  
- Ready to query with SQL, join with other tables, or feed into ML pipelines.  

---

## Programmatic Query with `ai_query`

Once your Information Extraction agent is deployed, you can query it directly with SQL:  

```sql
-- Query the extraction agent programmatically
SELECT *
FROM ai_query(
  "Retail-IE-Demo",   -- name of your extraction agent
  "Extract contract_value, customer_id, and term_months from the uploaded contracts"
);

